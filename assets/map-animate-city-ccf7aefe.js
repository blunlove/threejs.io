var re=Object.defineProperty;var oe=(u,e,t)=>e in u?re(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var R=(u,e,t)=>(oe(u,typeof e!="symbol"?e+"":e,t),t);import{R as le,F as ce,h as he,r as de,a as ue,f as Y,g as pe,c as ge,o as me,s as fe,b as ve,p as be,d as ye,e as we,G as A,V as b,i as ie,M as w,t as V,j as B,O as ae,S as se,E as xe,k as _,l as Ae,m as _e,L as D,n as Le,q as Ce,B as Ee,u as $e,v as Me,w as Se,C as M,x as Pe,y as ke,z as Ge,A as f,D as Fe,H as De,P as Be,I as N,J as X,K as q,N as k,Q as C,T as Ie,U as P,W as G,X as $,Y as Oe,Z as ze,_ as je,$ as I,a0 as J,a1 as Te,a2 as Ve,a3 as W,a4 as He,a5 as U,a6 as K,a7 as Re,a8 as Ye}from"./index-1fa41ed1.js";import{a as Ne,u as Xe,b as qe,o as Je,c as We,d as Q,e as Z,f as S,F as Ue,g as Ke,n as Qe,t as Ze}from"./index-265faec9.js";/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.17.0
 * @author George Michael Brower
 * @license MIT
 */class E{constructor(e,t,i,s,a="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(s),this.$name=document.createElement("div"),this.$name.classList.add("name"),E.nextNameID=E.nextNameID||0,this.$name.id="lil-gui-name-"+ ++E.nextNameID,this.$widget=document.createElement(a),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class et extends E{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function T(u){let e,t;return(e=u.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=u.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=u.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const tt={isPrimitive:!0,match:u=>typeof u=="string",fromHexString:T,toHexString:T},F={isPrimitive:!0,match:u=>typeof u=="number",fromHexString:u=>parseInt(u.substring(1),16),toHexString:u=>"#"+u.toString(16).padStart(6,0)},it={isPrimitive:!1,match:Array.isArray,fromHexString(u,e,t=1){const i=F.fromHexString(u);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(255&i)/255*t},toHexString:([u,e,t],i=1)=>F.toHexString(u*(i=255/i)<<16^e*i<<8^t*i<<0)},at={isPrimitive:!1,match:u=>Object(u)===u,fromHexString(u,e,t=1){const i=F.fromHexString(u);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(255&i)/255*t},toHexString:({r:u,g:e,b:t},i=1)=>F.toHexString(u*(i=255/i)<<16^e*i<<8^t*i<<0)},st=[tt,F,it,at];class nt extends E{constructor(e,t,i,s){var a;super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(a=this.initialValue,st.find(n=>n.match(a))),this._rgbScale=s,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const n=T(this.$text.value);n&&this._setValueFromHexString(n)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class O extends E{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",s=>{s.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class rt extends E{constructor(e,t,i,s,a,n){super(e,t,i,"number"),this._initInput(),this.min(s),this.max(a);const h=n!==void 0;this.step(h?n:this._getImplicitStep(),h),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const e=r=>{const p=parseFloat(this.$input.value);isNaN(p)||(this._snapClampSetValue(p+r),this.$input.value=this.getValue())};let t,i,s,a,n,h=!1;const o=r=>{if(h){const p=r.clientX-t,c=r.clientY-i;Math.abs(c)>5?(r.preventDefault(),this.$input.blur(),h=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(p)>5&&l()}if(!h){const p=r.clientY-s;n-=p*this._step*this._arrowKeyMultiplier(r),a+n>this._max?n=this._max-a:a+n<this._min&&(n=this._min-a),this._snapClampSetValue(a+n)}s=r.clientY},l=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",l)};this.$input.addEventListener("input",()=>{let r=parseFloat(this.$input.value);isNaN(r)||(this._stepExplicit&&(r=this._snap(r)),this.setValue(this._clamp(r)))}),this.$input.addEventListener("keydown",r=>{r.code==="Enter"&&this.$input.blur(),r.code==="ArrowUp"&&(r.preventDefault(),e(this._step*this._arrowKeyMultiplier(r))),r.code==="ArrowDown"&&(r.preventDefault(),e(this._step*this._arrowKeyMultiplier(r)*-1))}),this.$input.addEventListener("wheel",r=>{this._inputFocused&&(r.preventDefault(),e(this._step*this._normalizeMouseWheel(r)))},{passive:!1}),this.$input.addEventListener("mousedown",r=>{t=r.clientX,i=s=r.clientY,h=!0,a=this.getValue(),n=0,window.addEventListener("mousemove",o),window.addEventListener("mouseup",l)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=c=>{const d=this.$slider.getBoundingClientRect();let m=(g=c,v=d.left,y=d.right,x=this._min,L=this._max,(g-v)/(y-v)*(L-x)+x);var g,v,y,x,L;this._snapClampSetValue(m)},t=c=>{e(c.clientX)},i=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",i)};let s,a,n=!1;const h=c=>{c.preventDefault(),this._setDraggingStyle(!0),e(c.touches[0].clientX),n=!1},o=c=>{if(n){const d=c.touches[0].clientX-s,m=c.touches[0].clientY-a;Math.abs(d)>Math.abs(m)?h(c):(window.removeEventListener("touchmove",o),window.removeEventListener("touchend",l))}else c.preventDefault(),e(c.touches[0].clientX)},l=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",o),window.removeEventListener("touchend",l)},r=this._callOnFinishChange.bind(this);let p;this.$slider.addEventListener("mousedown",c=>{this._setDraggingStyle(!0),e(c.clientX),window.addEventListener("mousemove",t),window.addEventListener("mouseup",i)}),this.$slider.addEventListener("touchstart",c=>{c.touches.length>1||(this._hasScrollBar?(s=c.touches[0].clientX,a=c.touches[0].clientY,n=!0):h(c),window.addEventListener("touchmove",o,{passive:!1}),window.addEventListener("touchend",l))},{passive:!1}),this.$slider.addEventListener("wheel",c=>{if(Math.abs(c.deltaX)<Math.abs(c.deltaY)&&this._hasScrollBar)return;c.preventDefault();const d=this._normalizeMouseWheel(c)*this._step;this._snapClampSetValue(this.getValue()+d),this.$input.value=this.getValue(),clearTimeout(p),p=setTimeout(r,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle("lil-gui-"+t,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class ot extends E{constructor(e,t,i,s){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(s)?s:Object.values(s),this._names=Array.isArray(s)?s:Object.keys(s),this._names.forEach(a=>{const n=document.createElement("option");n.innerHTML=a,this.$select.appendChild(n)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=t===-1?e:this._names[t],this}}class lt extends E{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",s=>{s.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let ee=!1;class H{constructor({parent:e,autoPlace:t=e===void 0,container:i,width:s,title:a="Controls",injectStyles:n=!0,touchStyles:h=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",o=>{o.code!=="Enter"&&o.code!=="Space"||(o.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(a),h&&this.domElement.classList.add("allow-touch-styles"),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),!ee&&n&&(function(o){const l=document.createElement("style");l.innerHTML=o;const r=document.querySelector("head link[rel=stylesheet], head style");r?document.head.insertBefore(l,r):document.head.appendChild(l)}('.lil-gui{--background-color:#1f1f1f;--text-color:#ebebeb;--title-background-color:#111;--title-text-color:#ebebeb;--widget-color:#424242;--hover-color:#4f4f4f;--focus-color:#595959;--number-color:#2cc9ff;--string-color:#a2db3c;--font-size:11px;--input-font-size:11px;--font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;--font-family-mono:Menlo,Monaco,Consolas,"Droid Sans Mono",monospace;--padding:4px;--spacing:4px;--widget-height:20px;--name-width:45%;--slider-knob-width:2px;--slider-input-width:27%;--color-input-width:27%;--slider-input-min-width:45px;--color-input-min-width:45px;--folder-indent:7px;--widget-padding:0 0 0 3px;--widget-border-radius:2px;--checkbox-size:calc(var(--widget-height)*0.75);--scrollbar-width:5px;background-color:var(--background-color);color:var(--text-color);font-family:var(--font-family);font-size:var(--font-size);font-style:normal;font-weight:400;line-height:1;text-align:left;touch-action:manipulation;user-select:none;-webkit-user-select:none}.lil-gui,.lil-gui *{box-sizing:border-box;margin:0;padding:0}.lil-gui.root{display:flex;flex-direction:column;width:var(--width,245px)}.lil-gui.root>.title{background:var(--title-background-color);color:var(--title-text-color)}.lil-gui.root>.children{overflow-x:hidden;overflow-y:auto}.lil-gui.root>.children::-webkit-scrollbar{background:var(--background-color);height:var(--scrollbar-width);width:var(--scrollbar-width)}.lil-gui.root>.children::-webkit-scrollbar-thumb{background:var(--focus-color);border-radius:var(--scrollbar-width)}.lil-gui.force-touch-styles{--widget-height:28px;--padding:6px;--spacing:6px;--font-size:13px;--input-font-size:16px;--folder-indent:10px;--scrollbar-width:7px;--slider-input-min-width:50px;--color-input-min-width:65px}.lil-gui.autoPlace{max-height:100%;position:fixed;right:15px;top:0;z-index:1001}.lil-gui .controller{align-items:center;display:flex;margin:var(--spacing) 0;padding:0 var(--padding)}.lil-gui .controller.disabled{opacity:.5}.lil-gui .controller.disabled,.lil-gui .controller.disabled *{pointer-events:none!important}.lil-gui .controller>.name{flex-shrink:0;line-height:var(--widget-height);min-width:var(--name-width);padding-right:var(--spacing);white-space:pre}.lil-gui .controller .widget{align-items:center;display:flex;min-height:var(--widget-height);position:relative;width:100%}.lil-gui .controller.string input{color:var(--string-color)}.lil-gui .controller.boolean .widget{cursor:pointer}.lil-gui .controller.color .display{border-radius:var(--widget-border-radius);height:var(--widget-height);position:relative;width:100%}.lil-gui .controller.color input[type=color]{cursor:pointer;height:100%;opacity:0;width:100%}.lil-gui .controller.color input[type=text]{flex-shrink:0;font-family:var(--font-family-mono);margin-left:var(--spacing);min-width:var(--color-input-min-width);width:var(--color-input-width)}.lil-gui .controller.option select{max-width:100%;opacity:0;position:absolute;width:100%}.lil-gui .controller.option .display{background:var(--widget-color);border-radius:var(--widget-border-radius);height:var(--widget-height);line-height:var(--widget-height);max-width:100%;overflow:hidden;padding-left:.55em;padding-right:1.75em;pointer-events:none;position:relative;word-break:break-all}.lil-gui .controller.option .display.active{background:var(--focus-color)}.lil-gui .controller.option .display:after{bottom:0;content:"↕";font-family:lil-gui;padding-right:.375em;position:absolute;right:0;top:0}.lil-gui .controller.option .widget,.lil-gui .controller.option select{cursor:pointer}.lil-gui .controller.number input{color:var(--number-color)}.lil-gui .controller.number.hasSlider input{flex-shrink:0;margin-left:var(--spacing);min-width:var(--slider-input-min-width);width:var(--slider-input-width)}.lil-gui .controller.number .slider{background-color:var(--widget-color);border-radius:var(--widget-border-radius);cursor:ew-resize;height:var(--widget-height);overflow:hidden;padding-right:var(--slider-knob-width);touch-action:pan-y;width:100%}.lil-gui .controller.number .slider.active{background-color:var(--focus-color)}.lil-gui .controller.number .slider.active .fill{opacity:.95}.lil-gui .controller.number .fill{border-right:var(--slider-knob-width) solid var(--number-color);box-sizing:content-box;height:100%}.lil-gui-dragging .lil-gui{--hover-color:var(--widget-color)}.lil-gui-dragging *{cursor:ew-resize!important}.lil-gui-dragging.lil-gui-vertical *{cursor:ns-resize!important}.lil-gui .title{--title-height:calc(var(--widget-height) + var(--spacing)*1.25);-webkit-tap-highlight-color:transparent;text-decoration-skip:objects;cursor:pointer;font-weight:600;height:var(--title-height);line-height:calc(var(--title-height) - 4px);outline:none;padding:0 var(--padding)}.lil-gui .title:before{content:"▾";display:inline-block;font-family:lil-gui;padding-right:2px}.lil-gui .title:active{background:var(--title-background-color);opacity:.75}.lil-gui.root>.title:focus{text-decoration:none!important}.lil-gui.closed>.title:before{content:"▸"}.lil-gui.closed>.children{opacity:0;transform:translateY(-7px)}.lil-gui.closed:not(.transition)>.children{display:none}.lil-gui.transition>.children{overflow:hidden;pointer-events:none;transition-duration:.3s;transition-property:height,opacity,transform;transition-timing-function:cubic-bezier(.2,.6,.35,1)}.lil-gui .children:empty:before{content:"Empty";display:block;font-style:italic;height:var(--widget-height);line-height:var(--widget-height);margin:var(--spacing) 0;opacity:.5;padding:0 var(--padding)}.lil-gui.root>.children>.lil-gui>.title{border-width:0;border-bottom:1px solid var(--widget-color);border-left:0 solid var(--widget-color);border-right:0 solid var(--widget-color);border-top:1px solid var(--widget-color);transition:border-color .3s}.lil-gui.root>.children>.lil-gui.closed>.title{border-bottom-color:transparent}.lil-gui+.controller{border-top:1px solid var(--widget-color);margin-top:0;padding-top:var(--spacing)}.lil-gui .lil-gui .lil-gui>.title{border:none}.lil-gui .lil-gui .lil-gui>.children{border:none;border-left:2px solid var(--widget-color);margin-left:var(--folder-indent)}.lil-gui .lil-gui .controller{border:none}.lil-gui input{-webkit-tap-highlight-color:transparent;background:var(--widget-color);border:0;border-radius:var(--widget-border-radius);color:var(--text-color);font-family:var(--font-family);font-size:var(--input-font-size);height:var(--widget-height);outline:none;width:100%}.lil-gui input:disabled{opacity:1}.lil-gui input[type=number],.lil-gui input[type=text]{padding:var(--widget-padding)}.lil-gui input[type=number]:focus,.lil-gui input[type=text]:focus{background:var(--focus-color)}.lil-gui input::-webkit-inner-spin-button,.lil-gui input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.lil-gui input[type=number]{-moz-appearance:textfield}.lil-gui input[type=checkbox]{appearance:none;-webkit-appearance:none;border-radius:var(--widget-border-radius);cursor:pointer;height:var(--checkbox-size);text-align:center;width:var(--checkbox-size)}.lil-gui input[type=checkbox]:checked:before{content:"✓";font-family:lil-gui;font-size:var(--checkbox-size);line-height:var(--checkbox-size)}.lil-gui button{-webkit-tap-highlight-color:transparent;background:var(--widget-color);border:1px solid var(--widget-color);border-radius:var(--widget-border-radius);color:var(--text-color);cursor:pointer;font-family:var(--font-family);font-size:var(--font-size);height:var(--widget-height);line-height:calc(var(--widget-height) - 4px);outline:none;text-align:center;text-transform:none;width:100%}.lil-gui button:active{background:var(--focus-color)}@font-face{font-family:lil-gui;src:url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff")}@media (pointer:coarse){.lil-gui.allow-touch-styles{--widget-height:28px;--padding:6px;--spacing:6px;--font-size:13px;--input-font-size:16px;--folder-indent:10px;--scrollbar-width:7px;--slider-input-min-width:50px;--color-input-min-width:65px}}@media (hover:hover){.lil-gui .controller.color .display:hover:before{border:1px solid #fff9;border-radius:var(--widget-border-radius);bottom:0;content:" ";display:block;left:0;position:absolute;right:0;top:0}.lil-gui .controller.option .display.focus{background:var(--focus-color)}.lil-gui .controller.option .widget:hover .display{background:var(--hover-color)}.lil-gui .controller.number .slider:hover{background-color:var(--hover-color)}body:not(.lil-gui-dragging) .lil-gui .title:hover{background:var(--title-background-color);opacity:.85}.lil-gui .title:focus{text-decoration:underline var(--focus-color)}.lil-gui input:hover{background:var(--hover-color)}.lil-gui input:active{background:var(--focus-color)}.lil-gui input[type=checkbox]:focus{box-shadow:inset 0 0 0 1px var(--focus-color)}.lil-gui button:hover{background:var(--hover-color);border-color:var(--hover-color)}.lil-gui button:focus{border-color:var(--focus-color)}}'),ee=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),s&&this.domElement.style.setProperty("--width",s+"px"),this.domElement.addEventListener("keydown",o=>o.stopPropagation()),this.domElement.addEventListener("keyup",o=>o.stopPropagation())}add(e,t,i,s,a){if(Object(i)===i)return new ot(this,e,t,i);const n=e[t];switch(typeof n){case"number":return new rt(this,e,t,i,s,a);case"boolean":return new et(this,e,t);case"string":return new lt(this,e,t);case"function":return new O(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,n)}addColor(e,t,i=1){return new nt(this,e,t,i)}addFolder(e){return new H({parent:this,title:e})}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof O||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof O)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._closed=!e,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const i=a=>{a.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const s=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=s+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(t=>t.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}class ct{constructor(e=null,t="浙江省",i="温州市"){this.onLoadCallback=e,this.province=t,this.city=i,this.init()}init(){this.instance=new le,this.instance.addLoader(ce,"FileLoader"),this.instance.on("onProgress",(i,s,a)=>{(s/a*100).toFixed(2)+""}),this.instance.on("onLoad",()=>{this.onLoadCallback&&this.onLoadCallback()});let e="./",t=[{type:"Texture",name:"huiguang",path:he},{type:"Texture",name:"rotationBorder1",path:de},{type:"Texture",name:"rotationBorder2",path:ue},{type:"Texture",name:"guangquan1",path:Y},{type:"Texture",name:"guangquan2",path:pe},{type:"Texture",name:"chinaBlurLine",path:ge},{type:"Texture",name:"ocean",path:me},{type:"Texture",name:"side",path:fe},{type:"Texture",name:"flyLine",path:ve},{type:"Texture",name:"flyLineFocus",path:Y},{type:"Texture",name:"pathLine",path:be},{type:"Texture",name:"arrow",path:ye},{type:"Texture",name:"point",path:we},{type:"File",name:"province",path:`${e}assets/json/${this.province}/index.json`},{type:"File",name:"city",path:`${e}assets/json/${this.province}/city/${this.city}.json`}];this.instance.loadAll(t)}}class ht{constructor({assets:e,time:t},i={}){this.mapGroup=new A,this.assets=e,this.time=t,this.coordinates=[],this.config=Object.assign({position:new b(0,0,0),center:new ie(0,0),data:"",renderOrder:1,topFaceMaterial:new w({color:1582651,transparent:!0,opacity:1}),sideMaterial:new w({color:464171,transparent:!0,opacity:1}),depth:.1},i),this.mapGroup.position.copy(this.config.position);let s=V(this.config.data);this.create(s)}geoProjection(e){return B().center(this.config.center).scale(300).translate([0,0])(e)}create(e){e.features.forEach(t=>{const i=new ae;let{name:s,center:a=[],centroid:n=[]}=t.properties;this.coordinates.push({name:s,center:a,centroid:n});const h={depth:this.config.depth,bevelEnabled:!0,bevelSegments:1,bevelThickness:.1};let o=[this.config.topFaceMaterial,this.config.sideMaterial];t.geometry.coordinates.forEach(l=>{l.forEach((r,p)=>{const c=new se;for(let g=0;g<r.length;g++){if(!r[g][0]||!r[g][1])return!1;const[v,y]=this.geoProjection(r[g]);g===0&&c.moveTo(v,-y),c.lineTo(v,-y)}const d=new xe(c,h),m=new _(d,o);i.add(m)})}),this.mapGroup.add(i)})}getCoordinates(){return this.coordinates}setParent(e){e.add(this.mapGroup)}}class te{constructor({},e={}){this.mapGroup=new A,this.coordinates=[],this.config=Object.assign({position:new b(0,0,0),center:new ie(0,0),data:"",renderOrder:1,merge:!1,material:new w({color:1582651,transparent:!0,opacity:1})},e),this.mapGroup.position.copy(this.config.position);let t=V(this.config.data);this.create(t)}geoProjection(e){return B().center(this.config.center).scale(300).translate([0,0])(e)}create(e){let{merge:t}=this.config,i=[];if(e.features.forEach(s=>{const a=new ae;let{name:n,center:h=[],centroid:o=[]}=s.properties;this.coordinates.push({name:n,center:h,centroid:o}),a.userData.name=n,s.geometry.coordinates.forEach(l=>{l.forEach(r=>{const p=new se;for(let d=0;d<r.length;d++){if(!r[d][0]||!r[d][1])return!1;const[m,g]=this.geoProjection(r[d]);d===0&&p.moveTo(m,-g),p.lineTo(m,-g)}const c=new Ae(p);if(t)i.push(c);else{const d=new _(c,this.config.material);d.renderOrder=this.config.renderOrder,d.userData.name=n,a.add(d)}})}),t||this.mapGroup.add(a)}),t){let s=_e(i);const a=new _(s,this.config.material);a.renderOrder=this.config.renderOrder,this.mapGroup.add(a)}}getCoordinates(){return this.coordinates}setParent(e){e.add(this.mapGroup)}}class z{constructor({},e={}){this.config=Object.assign({visibelProvince:"",center:[0,0],data:"",material:new D({color:16777215}),type:"LineLoop",renderOrder:1},e);let t=V(this.config.data),i=this.create(t);this.lineGroup=i}geoProjection(e){return B().center(this.config.center).scale(300).translate([0,0])(e)}create(e){const{type:t,visibelProvince:i}=this.config;let s=e.features,a=new A;for(let n=0;n<s.length;n++){const h=s[n];h.properties.name!==i&&h.geometry.coordinates.forEach(o=>{const l=[];let r=null;t==="Line2"?(o[0].forEach(p=>{const[c,d]=this.geoProjection(p);l.push(c,-d,0)}),r=this.createLine2(l)):o[0].forEach(p=>{const[c,d]=this.geoProjection(p);l.push(new b(c,-d,0)),r=this.createLine(l)}),a.add(r)})}return a}createLine2(e){const{material:t,renderOrder:i}=this.config,s=new Le;s.setPositions(e);let a=new Ce(s,t);return a.name="mapLine2",a.renderOrder=i,a.computeLineDistances(),a}createLine(e){const{material:t,renderOrder:i,type:s}=this.config,a=new Ee;a.setFromPoints(e);let n=new $e(a,t);return n.renderOrder=i,n.name="mapLine",n}setParent(e){e.add(this.lineGroup)}}const dt=[{value:166,lng:119.00838863314104,lat:29.70446787438727},{value:196,lng:121.95888480416225,lat:29.804570962222094},{value:145,lng:121.1763690119717,lat:29.943827249850777},{value:101,lng:121.56920938135673,lat:29.85263574108389},{value:199,lng:120.9772766279951,lat:28.330342193214033},{value:167,lng:120.33101898043361,lat:30.565600410098323},{value:169,lng:120.36095289685078,lat:30.739761809104824},{value:101,lng:119.983185482632,lat:31.03706617454779},{value:121,lng:121.20282810334723,lat:29.45300711212515},{value:132,lng:120.04632515461387,lat:29.535586166289217},{value:132,lng:119.88396764642604,lat:29.24289373808931},{value:119,lng:118.20295164180662,lat:28.97847155167772},{value:138,lng:119.30239039019484,lat:28.963362607831762},{value:183,lng:122.11925213943688,lat:30.09279983271788},{value:103,lng:122.0641872449813,lat:30.624331727210976},{value:110,lng:121.24428726916929,lat:28.29819603626963},{value:171,lng:120.83475957600818,lat:29.104535097251688},{value:174,lng:119.70182146944745,lat:28.267110085326326}],ut=[{name:"监测点#01",level:"差",value:84.9,lng:118.27595005,lat:29.11596322},{name:"监测点#02",level:"极好",value:12.5,lng:118.94093792,lat:27.90619049},{name:"监测点#03",level:"良好",value:52.8,lng:121.35456753,lat:28.34783376},{name:"监测点#04",level:"好",value:32,lng:122.10985921,lat:30.05331943}];function j(u){return u.sort((e,t)=>t.value-e.value),u}class pt extends Me{constructor(t,{province:i,city:s}){super(t);R(this,"initGui",()=>{const t=new H,i={topColor:"#b4eeea",sideColor:"#123024",scale:.1};t.addColor(i,"topColor").onChange(s=>{topFaceMaterial.color=new M(s)}),t.addColor(i,"sideColor").onChange(s=>{sideMaterial.color=new M(s)}),t.add(i,"scale",0,1).onChange(s=>{textureMap.repeat.set(s,s),texturefxMap.repeat.set(s,s)})});this.depth=.5,this.clicked=!1,this.scene.fog=new Se(1058614,1,50),this.scene.background=new M(1058614),this.camera.instance.position.set(-13.767695123014105,12.990152163077308,39.28228164159694),this.camera.instance.near=1,this.camera.instance.far=1e4,this.camera.instance.updateProjectionMatrix(),this.interactionManager=new Pe(this.renderer.instance,this.camera.instance,this.canvas),this.province=i,this.city=s,this.playing=!1,this.initEnvironment(),this.assets=new ct(()=>{var n,h;this.cityData=JSON.parse((n=this.assets.instance.assets.find(o=>o.name==="city"))==null?void 0:n.data).features.map(o=>({name:o.properties.name,enName:ke(o.properties.name,{toneType:"none"}).replace(/\s*/g,""),value:98,center:o.properties.center||o.properties.centroid,centroid:o.properties.centroid||o.properties.center})),this.provinceData=JSON.parse((h=this.assets.instance.assets.find(o=>o.name==="province"))==null?void 0:h.data).features.filter(o=>o.properties.name).map(o=>({name:o.properties.name,center:o.properties.center||o.properties.centroid,centroid:o.properties.centroid||o.properties.center})),this.pointCenter=this.cityData[0].centroid,this.flyLineCenter=this.cityData[0].centroid,this.labelGroup=new A,this.label3d=new Ge(this),this.labelGroup.rotateX(-Math.PI/2),this.eventElement=[],this.defaultMaterial=null,this.defaultLightMaterial=null,this.scene.add(this.labelGroup),this.createFloor(),this.createGrid(),this.createRotateBorder(),this.createLabel(),this.createMap(),this.createAnimateVideo(),this.createEvent(),setTimeout(()=>{this.createFlyLine(!0)},5e3),this.createParticles();let a=f.timeline();a.addLabel("focusMap",2),a.addLabel("focusMapOpacity",2.5),a.addLabel("bar",3.5),a.add(f.to(this.camera.instance.position,{duration:2.5,x:-.2515849818960619,y:12.397744557047988,z:14.647659671139275,ease:"circ.out"})),a.add(f.to(this.focusMapGroup.position,{duration:1,x:0,y:0,z:0}),"focusMap"),a.add(f.to(this.focusMapGroup.scale,{duration:1,x:1,y:1,z:1,ease:"circ.out"}),"focusMap"),a.add(f.to(this.focusMapTopMaterial,{duration:1,opacity:1,ease:"circ.out"}),"focusMapOpacity"),a.add(f.to(this.focusMapSideMaterial,{duration:1,opacity:1,ease:"circ.out",onComplete:()=>{this.focusMapSideMaterial.transparent=!1}}),"focusMapOpacity"),a.add(f.to(this.zhejiangLineMaterial,{duration:.5,delay:.3,opacity:1}),"focusMapOpacity"),a.add(f.to(this.rotateBorder1.scale,{delay:.3,duration:1,x:1,y:1,z:1,ease:"circ.out"}),"focusMapOpacity"),a.add(f.to(this.rotateBorder2.scale,{duration:1,delay:.5,x:1,y:1,z:1,ease:"circ.out"}),"focusMapOpacity"),this.addOtherLabel(a),this.addBar(a),this.addAllCityLabel(a)},this.province,this.city)}initCamera(){this.camera.instance.position.set(-13.767695123014105,12.990152163077308,39.28228164159694),this.camera.instance.near=1,this.camera.instance.far=1e4,this.camera.instance.updateProjectionMatrix()}initEnvironment(){let t=new Fe(16777215,5);this.scene.add(t);let i=new De(16777215,5);i.position.set(-30,6,-8),i.castShadow=!0,i.shadow.radius=20,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,this.scene.add(i),this.createPointLight({color:"#1d5e5e",intensity:600,distance:1e4,x:-9,y:3,z:-3}),this.createPointLight({color:"#1d5e5e",intensity:100,distance:1e4,x:0,y:2,z:5})}createPointLight(t){const i=new Be(1924702,t.intensity,t.distance);i.position.set(t.x,t.y,t.z),this.scene.add(i)}addOtherLabel(t){this.otherLabel.map((i,s)=>{let a=i.element.querySelector(".other-label");t.add(f.to(a,{duration:1,delay:.1*s,translateY:0,opacity:1,ease:"circ.out"}),"focusMapOpacity")})}addBar(t){this.allBar.map((i,s)=>{t.add(f.to(i.scale,{duration:1,delay:.1*s,x:1,y:1,z:1,ease:"circ.out"}),"bar")}),this.allBarMaterial.map((i,s)=>{t.add(f.to(i,{duration:1,delay:.1*s,opacity:1,ease:"circ.out"}),"bar")})}addAllCityLabel(t){this.allCityLabel.map((i,s)=>{let a=i.element.querySelector(".provinces-label-wrap"),n=i.element.querySelector(".number .value"),h=Number(n.innerText),o={score:0};t.add(f.to(a,{duration:1,delay:.2*s,translateY:0,opacity:1,ease:"circ.out"}),"bar");let l=f.to(o,{duration:1,delay:.2*s,score:h,onUpdate:r});function r(){n.innerText=o.score.toFixed(0)}t.add(l,"bar")}),this.allGuangquan.map((i,s)=>{t.add(f.to(i.children[0].scale,{duration:1,delay:.1*s,x:1,y:1,z:1,ease:"circ.out"}),"bar"),t.add(f.to(i.children[1].scale,{duration:1,delay:.1*s,x:1,y:1,z:1,ease:"circ.out"}),"bar")})}createMap(){let t=new A,i=new A;this.focusMapGroup=i;let{china:s,chinaTopLine:a}=this.createProvince(),{zhejiang:n,zhejiangTop:h,guangdonLine:o}=this.createCity();s.setParent(t),a.setParent(t),n.setParent(i),h.setParent(i),o.setParent(i),i.position.set(0,0,-.01),i.scale.set(1,1,0),t.add(i),t.rotateX(-Math.PI/2),t.position.set(0,.2,0),this.scene.add(t),this.createBar()}createProvince(){let t=this.assets.instance.getResource("province"),i=new te(this,{data:t,center:this.pointCenter,merge:!1,material:new N({color:1387591,transparent:!0,opacity:1}),renderOrder:2}),s=new z(this,{center:this.pointCenter,visibelProvince:this.city,data:t,material:new D({color:4162253}),renderOrder:3});s.lineGroup.position.z+=.01;let a=new z(this,{center:this.pointCenter,data:t,material:new D({color:4162253,transparent:!0,opacity:.4}),renderOrder:3});return a.lineGroup.position.z-=.59,{china:i,chinaTopLine:s,chinaBottomLine:a}}createCity(){let t=this.assets.instance.getResource("city"),[i,s]=this.createProvinceMaterial();this.focusMapTopMaterial=i,this.focusMapSideMaterial=s;let a=new ht(this,{center:this.pointCenter,position:new b(0,0,.11),data:t,depth:.5,topFaceMaterial:i,sideMaterial:s,renderOrder:9}),n=new X({color:16777215,transparent:!0,opacity:.1});new q(n,{uColor1:2780818,uColor2:1058614}),this.defaultMaterial=n,this.defaultLightMaterial=this.defaultMaterial.clone(),this.defaultLightMaterial.emissive.setHex(725293),this.defaultLightMaterial.emissiveIntensity=3.5;let h=new te(this,{center:this.pointCenter,position:new b(0,0,.72),data:t,material:n,renderOrder:2});h.mapGroup.children.map(l=>{l.children.map(r=>{r.type==="Mesh"&&this.eventElement.push(r)})}),this.zhejiangLineMaterial=new D({color:16777215,opacity:0,transparent:!0,fog:!1});let o=new z(this,{center:this.pointCenter,data:t,material:this.zhejiangLineMaterial,renderOrder:3});return o.lineGroup.position.z+=.72,{zhejiang:a,zhejiangTop:h,guangdonLine:o}}createProvinceMaterial(){let t=new N({color:16777215,transparent:!0,opacity:0,fog:!1,side:k});t.onBeforeCompile=a=>{a.uniforms={...a.uniforms,uColor1:{value:new M(2780818)},uColor2:{value:new M(1058614)}},a.vertexShader=a.vertexShader.replace("void main() {",`
        attribute float alpha;
        varying vec3 vPosition;
        varying float vAlpha;
        void main() {
          vAlpha = alpha;
          vPosition = position;
      `),a.fragmentShader=a.fragmentShader.replace("void main() {",`
        varying vec3 vPosition;
        varying float vAlpha;
        uniform vec3 uColor1;
        uniform vec3 uColor2;
      
        void main() {
      `),a.fragmentShader=a.fragmentShader.replace("#include <opaque_fragment>",`
      #ifdef OPAQUE
      diffuseColor.a = 1.0;
      #endif
      
      // https://github.com/mrdoob/three.js/pull/22425
      #ifdef USE_TRANSMISSION
      diffuseColor.a *= transmissionAlpha + 0.1;
      #endif
      vec3 gradient = mix(uColor1, uColor2, vPosition.x/15.78); // 15.78
      
      outgoingLight = outgoingLight*gradient;
     
      if(vPosition.z>0.3){
        diffuseColor.a *= 0.5;
      }
      
      gl_FragColor = vec4( outgoingLight, diffuseColor.a  );
      `)};let i=this.assets.instance.getResource("side");i.wrapS=C,i.wrapT=C,i.repeat.set(1,1.5),i.offset.y+=.065;let s=new X({color:16777215,map:i,fog:!1,side:k});return this.time.on("tick",()=>{i.offset.y+=.005}),s.onBeforeCompile=a=>{a.uniforms={...a.uniforms,uColor1:{value:new M(2780818)},uColor2:{value:new M(2780818)}},a.vertexShader=a.vertexShader.replace("void main() {",`
        attribute float alpha;
        varying vec3 vPosition;
        varying float vAlpha;
        void main() {
          vAlpha = alpha;
          vPosition = position;
      `),a.fragmentShader=a.fragmentShader.replace("void main() {",`
        varying vec3 vPosition;
        varying float vAlpha;
        uniform vec3 uColor1;
        uniform vec3 uColor2;
      
        void main() {
      `),a.fragmentShader=a.fragmentShader.replace("#include <opaque_fragment>",`
      #ifdef OPAQUE
      diffuseColor.a = 1.0;
      #endif
      
      // https://github.com/mrdoob/three.js/pull/22425
      #ifdef USE_TRANSMISSION
      diffuseColor.a *= transmissionAlpha + 0.1;
      #endif
      vec3 gradient = mix(uColor1, uColor2, vPosition.z/1.2);
      
      outgoingLight = outgoingLight*gradient;
      
      
      gl_FragColor = vec4( outgoingLight, diffuseColor.a  );
      `)},[t,s]}createBar(){let t=this,i=j(this.cityData);const s=new A,a=.7,n=4*a,h=i[0].value;this.allBar=[],this.allBarMaterial=[],this.allGuangquan=[],this.allCityLabel=[],i.map((l,r)=>{let p=n*(l.value/h),c=new w({color:16777215,transparent:!0,opacity:0,depthTest:!1,fog:!1});new q(c,{uColor1:r>3?16506760:5291006,uColor2:r>3?16776948:7863285,size:p,dir:"y"});const d=new Ie(.1*a,.1*a,p);d.translate(0,0,p/2);const m=new _(d,c);m.renderOrder=5;let g=m,[v,y]=this.geoProjection(l.centroid);g.position.set(v,-y,.95),g.scale.set(1,1,0);let x=this.createQuan(new b(v,.94,y),r),L=this.createHUIGUANG(p,r>3?16776948:7863285);g.add(...L),s.add(g),s.rotation.x=-Math.PI/2;let ne=o(l,r,new b(v,-y,1.6+p));this.allBar.push(g),this.allBarMaterial.push(c),this.allGuangquan.push(x),this.allCityLabel.push(ne)}),this.scene.add(s);function o(l,r,p){let c=t.label3d.create("","provinces-label",!1);return c.init(`<div class='provinces-label ${r>4?"yellow":""}'>
      <div class='provinces-label-wrap'>
        <div class='number'><span class='value'>${l.value}</span><span class='unit'>万人</span></div>
        <div class='name'>
          <span class='zh'>${l.name}</span>
          <span class='en'>${l.enName.toUpperCase()}</span>
        </div>
        <div class='no'>${r+1}</div>
      </div>
    </div>`,p),t.label3d.setLabelStyle(c,.01,"x"),c.setParent(t.labelGroup),c}}createEvent(){let t=[];const i=a=>{a.traverse(n=>{n.isMesh&&(n.material=this.defaultMaterial)})},s=a=>{a.traverse(n=>{n.isMesh&&(n.material=this.defaultLightMaterial)})};this.eventElement.map(a=>{this.interactionManager.add(a),a.addEventListener("mousedown",n=>{console.log(n.target.userData.name)}),a.addEventListener("mouseover",n=>{t.includes(n.target.parent)||t.push(n.target.parent),document.body.style.cursor="pointer",s(n.target.parent)}),a.addEventListener("mouseout",n=>{t=t.filter(h=>h.userData.name!==n.target.parent.userData.name),t.length>0&&t[t.length-1],i(n.target.parent),document.body.style.cursor="default"})})}createHUIGUANG(t,i){let s=new P(.35,t);s.translate(0,t/2,0);const a=this.assets.instance.getResource("huiguang");a.colorSpace=G,a.wrapS=C,a.wrapT=C;let n=new w({color:i,map:a,transparent:!0,opacity:.4,depthWrite:!1,side:k,blending:$}),h=new _(s,n);h.renderOrder=10,h.rotateX(Math.PI/2);let o=h.clone(),l=h.clone();return o.rotateY(Math.PI/180*60),l.rotateY(Math.PI/180*120),[h,o,l]}createQuan(t,i){const s=this.assets.instance.getResource("guangquan1"),a=this.assets.instance.getResource("guangquan2");let n=new P(.5,.5),h=new w({color:16777215,map:s,alphaMap:s,opacity:1,transparent:!0,depthTest:!1,fog:!1,blending:$}),o=new w({color:16777215,map:a,alphaMap:a,opacity:1,transparent:!0,depthTest:!1,fog:!1,blending:$}),l=new _(n,h),r=new _(n,o);return l.renderOrder=6,r.renderOrder=6,l.rotateX(-Math.PI/2),r.rotateX(-Math.PI/2),l.position.copy(t),r.position.copy(t),r.position.y-=.001,l.scale.set(0,0,0),r.scale.set(0,0,0),this.quanGroup=new A,this.quanGroup.add(l,r),this.scene.add(this.quanGroup),this.time.on("tick",()=>{l.rotation.z+=.05}),this.quanGroup}createGrid(){new Oe(this,{gridSize:50,gridDivision:20,gridColor:1788784,shapeSize:.5,shapeColor:2776970,pointSize:.1,pointColor:1396093,diffuse:!0,diffuseSpeed:10,diffuseColor:3050457})}createFloor(){let t=new P(20,20);const i=this.assets.instance.getResource("ocean");i.colorSpace=G,i.wrapS=C,i.wrapT=C,i.repeat.set(1,1);let s=new w({map:i,opacity:1}),a=new _(t,s);a.rotateX(-Math.PI/2),a.position.set(0,-.7,0),this.scene.add(a)}createProvinceBlurLine(){let t=new P(147,147);const i=this.assets.instance.getResource("chinaBlurLine");i.colorSpace=G,i.wrapS=C,i.wrapT=C,i.generateMipmaps=!1,i.minFilter=ze,i.repeat.set(1,1);let s=new w({color:4162253,alphaMap:i,transparent:!0,opacity:.5}),a=new _(t,s);a.rotateX(-Math.PI/2),a.position.set(-33.2,-.5,-5.2),this.scene.add(a)}createAnimateVideo(){this.createAnimateVideoItem(".map-zj-video1",new b(-5,.4,-1))}createAnimateVideoItem(t,i){let s=document.querySelector(t);window.addEventListener("pointerdown",()=>{this.playing||(s.play(),this.playing=!0)});let a=new je(s);a.colorSpace=G;let n=1.2,h=new P(2.5*n,1*n),o=new w({color:10807286,alphaMap:a,transparent:!0,opacity:1,blending:$}),l=new _(h,o);l.rotateX(-Math.PI/2),l.position.copy(i),l.renderOrder=10,this.scene.add(l)}createLabel(){let t=this,i=this.labelGroup,s=this.label3d,a=this.provinceData.filter(r=>r.name!==this.city).map(r=>h(r,s,i)),n=o({name:this.city,enName:"ZHEJIANG PROVINCE",center:[this.pointCenter[0],this.pointCenter[1]-1.2]},s,i);l({icon:I,center:[125.109913,26.881466],width:"40px",height:"40px",reflect:!0},s,i),l({icon:I,center:[116.109913,26.881466],width:"20px",height:"20px",reflect:!1},s,i),a.push(n),this.otherLabel=a;function h(r,p,c){let d=p.create("","china-label",!1);const[m,g]=t.geoProjection(r.center);return d.init(`<div class='other-label'><img class='label-icon' src='${I}'>${r.name}</div>`,new b(m,-g,.4)),p.setLabelStyle(d,.02,"x"),d.setParent(c),d}function o(r,p,c){let d=p.create("","guangdong-label",!1);const[m,g]=t.geoProjection(r.center);return d.init(`<div class='other-label'><span>${r.name}</span><span>${r.enName}</span></div>`,new b(m,-g,.4)),p.setLabelStyle(d,.02,"x"),d.setParent(c),d}function l(r,p,c){let d=p.create("",`decoration-label  ${r.reflect?" reflect":""}`,!1);const[m,g]=t.geoProjection(r.center);return d.init(`<div class='other-label'><img class='label-icon' style='width:${r.width};height:${r.height}' src='${r.icon}'>`,new b(m,-g,.4)),p.setLabelStyle(d,.02,"x"),d.setParent(c),d}}createRotateBorder(){let t=12,i=this.assets.instance.getResource("rotationBorder1"),s=this.assets.instance.getResource("rotationBorder2"),a=new J(this,{width:t*1.178,needRotate:!0,rotateSpeed:.001,material:new w({map:i,color:4763647,transparent:!0,opacity:.2,side:k,depthWrite:!1,blending:$}),position:new b(0,.28,0)});a.instance.renderOrder=6,a.instance.scale.set(0,0,0),a.setParent(this.scene);let n=new J(this,{width:t*1.116,needRotate:!0,rotateSpeed:-.004,material:new w({map:s,color:4763647,transparent:!0,opacity:.4,side:k,depthWrite:!1,blending:$}),position:new b(0,.3,0)});n.instance.renderOrder=6,n.instance.scale.set(0,0,0),n.setParent(this.scene),this.rotateBorder1=a.instance,this.rotateBorder2=n.instance}createFlyLine(t=!1){this.flyLineGroup=new A,this.flyLineGroup.visible=t,this.scene.add(this.flyLineGroup);const i=this.assets.instance.getResource("flyLine");i.colorSpace=G,i.wrapS=C,i.wrapT=C,i.repeat.set(1,1);const s=.03,a=32,n=8,h=!1;let[o,l]=this.geoProjection(this.flyLineCenter),r=new b(o,-l,0);const p=new w({map:i,alphaMap:i,color:2781042,transparent:!0,fog:!1,opacity:1,depthTest:!1,blending:$});this.time.on("tick",()=>{i.offset.x-=.006}),this.cityData.map(c=>{let[d,m]=this.geoProjection(c.centroid),g=new b(d,-m,0);const v=new b;v.addVectors(r,g).multiplyScalar(.5),v.setZ(3);const y=new Te(r,v,g),x=new Ve(y,a,s,n,h),L=new _(x,p);L.rotation.x=-Math.PI/2,L.position.set(0,.94,0),L.renderOrder=21,this.flyLineGroup.add(L)}),this.createFlyLineFocus(!0)}createFlyLineFocus(t=!1){this.flyLineFocusGroup=new A,this.flyLineFocusGroup.visible=t,this.flyLineFocusGroup.rotation.x=-Math.PI/2;let[i,s]=this.geoProjection([119.476498,29.898918]);this.flyLineFocusGroup.position.set(i,.942,s),this.scene.add(this.flyLineFocusGroup);const a=this.assets.instance.getResource("flyLineFocus"),n=new P(1,1),h=new w({color:16777215,map:a,alphaMap:a,transparent:!0,fog:!1,depthTest:!1,blending:$}),o=new _(n,h);o.scale.set(0,0,0);const l=o.clone();l.material=h.clone(),this.flyLineFocusGroup.add(o,l),f.to(o.material,{opacity:0,repeat:-1,yoyo:!1,duration:1}),f.to(o.scale,{x:1.5,y:1.5,z:1.5,repeat:-1,yoyo:!1,duration:1}),f.to(l.material,{delay:.5,opacity:0,repeat:-1,yoyo:!1,duration:1}),f.to(l.scale,{delay:.5,x:1.5,y:1.5,z:1.5,repeat:-1,yoyo:!1,duration:1})}createParticles(){this.particles=new W(this,{num:10,range:30,dir:"up",speed:.05,material:new He({map:W.createTexture(),size:1,color:61166,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1,vertexColors:!0,blending:$,sizeAttenuation:!0})}),this.particles.instance.position.set(0,0,0),this.particles.instance.rotation.x=-Math.PI/2,this.particles.setParent(this.scene),this.particles.enable=!1,this.particles.instance.visible=!1}createScatter(){this.scatterGroup=new A,this.scatterGroup.visible=!1,this.scatterGroup.rotation.x=-Math.PI/2,this.scene.add(this.scatterGroup);const t=this.assets.instance.getResource("arrow"),i=new U({map:t,color:16776948,fog:!1,transparent:!0,depthTest:!1});let s=j(dt),a=s[0].value;s.map(n=>{const h=new K(i);h.renderOrder=23;let o=.1+n.value/a*.2;h.scale.set(o,o,o);let[l,r]=this.geoProjection([n.lng,n.lat]);h.position.set(l,-r,this.depth+.45),h.userData.position=[l,-r,this.depth+.45],this.scatterGroup.add(h)})}createInfoPoint(){let t=this;this.InfoPointGroup=new A,this.InfoPointGroup.visible=!1,this.InfoPointGroup.rotation.x=-Math.PI/2,this.scene.add(this.InfoPointGroup),this.infoPointIndex=0,this.infoPointLabelTime=null,this.infoLabelElement=[];let i=this.label3d;const s=this.assets.instance.getResource("point");let a=[16776948,7863285],n=j(ut),h=n[0].value;n.map((l,r)=>{const p=new U({map:s,color:a[r%a.length],fog:!1,transparent:!0,depthTest:!1}),c=new K(p);c.renderOrder=23;let d=.7+l.value/h*.4;c.scale.set(d,d,d);let[m,g]=this.geoProjection([l.lng,l.lat]),v=[m,-g,this.depth+.7];c.position.set(...v),c.userData.position=[...v],c.userData={position:[m,-g,this.depth+.7],name:l.name,value:l.value,level:l.level,index:r},this.InfoPointGroup.add(c);let y=o(l,i,this.InfoPointGroup);this.infoLabelElement.push(y),this.interactionManager.add(c),c.addEventListener("mousedown",x=>{if(this.clicked)return!1;this.clicked=!0,this.infoPointIndex=x.target.userData.index,this.infoLabelElement.map(L=>{L.hide()}),y.show(),this.createInfoPointLabelLoop()}),c.addEventListener("mouseup",x=>{this.clicked=!1}),c.addEventListener("mouseover",x=>{document.body.style.cursor="pointer"}),c.addEventListener("mouseout",x=>{document.body.style.cursor="default"})});function o(l,r,p){let c=r.create("","info-point",!0);const[d,m]=t.geoProjection([l.lng,l.lat]);return c.init(` <div class='info-point-wrap'>
        <div class='info-point-wrap-inner'>
          <div class='info-point-line'>
            <div class='line'></div>
            <div class='line'></div>
            <div class='line'></div>
          </div>
          <div class='info-point-content'>
            <div class='content-item'><span class='label'>名称</span><span class='value'>${l.name}</span></div>
            <div class='content-item'><span class='label'>PM2.5</span><span class='value'>${l.value}ug/m²</span></div>
            <div class='content-item'><span class='label'>等级</span><span class='value'>${l.level}</span></div>
          </div>
        </div>
      </div>
    `,new b(d,-m,2.4)),r.setLabelStyle(c,.015,"x"),c.setParent(p),c.hide(),c}}createInfoPointLabelLoop(){clearInterval(this.infoPointLabelTime),this.infoPointLabelTime=setInterval(()=>{this.infoPointIndex++,this.infoPointIndex>=this.infoLabelElement.length&&(this.infoPointIndex=0),this.infoLabelElement.map((t,i)=>{this.infoPointIndex===i?t.show():t.hide()})},3e3)}geoProjection(t){return B().center(this.pointCenter).scale(300).translate([0,0])(t)}update(){super.update(),this.interactionManager&&this.interactionManager.update()}destroy(){super.destroy(),this.label3d&&this.label3d.destroy()}}const gt={class:"map-gd"},mt=S("canvas",{id:"canvas"},null,-1),ft={ref:"video1",class:"map-gd-video map-zj-video1",width:"250",height:"100",loop:"",crossorigin:"anonymous",playsinline:"",style:{display:"none"}},vt=S("source",{src:Re},null,-1),bt=[vt],yt={ref:"video2",class:"map-gd-video map-zj-video2",width:"250",height:"100",loop:"",crossorigin:"anonymous",playsinline:"",style:{display:"none"}},wt=S("source",{src:Ye},null,-1),xt=[wt],At={class:"map-btn-group"},_t=["onClick"],$t={__name:"map-animate-city",setup(u){let e=null;const t=Ne({flyLine:!1,scatter:!1,particle:!1,path:!1,info:!1}),i=Xe(),s=qe(),a=[{type:"flyLine",label:"飞线",callback:()=>{t.flyLine=!t.flyLine,e.flyLineGroup.visible=t.flyLine,e.flyLineFocusGroup.visible=t.flyLine}},{type:"particle",label:"粒子特效",callback:()=>{t.particle=!t.particle,e.particles.enable=t.particle,e.particles.instance.visible=t.particle}},{label:"返回",callback:()=>{s.back()}}];return Je(()=>{e=new pt(document.getElementById("canvas"),{geoProjectionCenter:[120.109913,29.181466],province:i.query.province||"浙江省",city:i.query.name})}),We(()=>{e&&e.destroy()}),(n,h)=>(Q(),Z("div",gt,[mt,S("video",ft,bt,512),S("video",yt,xt,512),S("div",At,[(Q(),Z(Ue,null,Ke(a,o=>S("div",{class:Qe(["btn",{active:t[o.type]}]),onClick:o.callback},Ze(o.label),11,_t)),64))])]))}};export{$t as default};
